\begin{algorithm}[H] \label{algo:state_successor}
    \DontPrintSemicolon
    \SetAlgoLined
    \SetKwInOut{Input}{input}
    \SetKwInOut{Output}{output}
    \Input{$S$}
    \Output{$S_{new}$}
    \ForAll{$s \in S$}{
        $S_{new} \leftarrow \emptyset$\;
        $G \leftarrow GroupByHash(s.U)$ (algo. \ref{algo:group_by_hash})\;
        $placed \leftarrow false$\;
        \ForAll{$(h, I) \in G$}{
            \ForAll{$q_b \in s.Q$}{
                $P \leftarrow SPBestInsertion(q_b, I)$ (algo. \ref{algo:sp_bestinsertion})\;
                \If{$P \neq \emptyset$}{
                    $placed \leftarrow true$\;
                    \ForAll{$p \in P$}{
                        $S_{new} \leftarrow S_{new} \cup Next(s, p)$ (def. \ref{def:state_next})\;
                    }
                }
            }
        }
        \If{$placed = false$}{
            \CommentSty{Open a new bin with index $|s.B|$ (oss. \ref{oss:state_bin_open})}\;
            $S_{new} \leftarrow S_{new} \cup Next(s, (|s.B|, \emptyset))$\;
        }
    }
    \Return{$S_{new}$}
    \caption{Expand}
\end{algorithm}