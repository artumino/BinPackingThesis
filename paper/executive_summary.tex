% A LaTeX template for EXECUTIVE SUMMARY of the MSc Thesis submissions to 
% Politecnico di Milano (PoliMi) - School of Industrial and Information Engineering
%
% S. Bonetti, A. Gruttadauria, G. Mescolini, A. Zingaro
% e-mail: template-tesi-ingind@polimi.it
%
% Last Revision: October 2021
%
% Copyright 2021 Politecnico di Milano, Italy. NC-BY

\documentclass[11pt,a4paper,twocolumn]{article}

%------------------------------------------------------------------------------
%	REQUIRED PACKAGES AND  CONFIGURATIONS
%------------------------------------------------------------------------------
% PACKAGES FOR TITLES
\usepackage{titlesec}
\usepackage{color}

% PACKAGES FOR LANGUAGE AND FONT
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc} % Font encoding

% PACKAGES FOR IMAGES
\usepackage{graphicx}
\usepackage{tikz} % A package for high-quality hand-made figures.
\usetikzlibrary{}
\graphicspath{{./Images/}} % Directory of the images
\usepackage{eso-pic} % For the background picture on the title page
\usepackage{subfig} % Numbered and caption subfigures using \subfloat
\usepackage{caption} % Coloured captions
\usepackage{transparent}

% STANDARD MATH PACKAGES
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bm}
\usepackage[overload]{empheq}  % For braced-style systems of equations

% PACKAGES FOR TABLES
\usepackage{tabularx}
\usepackage{longtable} % tables that can span several pages
\usepackage{colortbl}

% PACKAGES FOR ALGORITHMS (PSEUDO-CODE)
\usepackage{algorithm}
\usepackage{algorithmic}

% PACKAGES FOR REFERENCES & BIBLIOGRAPHY
\usepackage[colorlinks=true,linkcolor=black,anchorcolor=black,citecolor=black,filecolor=black,menucolor=black,runcolor=black,urlcolor=black]{hyperref} % Adds clickable links at references
\usepackage{cleveref}
\usepackage[authoryear, square, numbers, sort&compress]{natbib} % Square brackets, citing references with numbers, citations sorted by appearance in the text and compressed
\bibliographystyle{apalike} % You may use a different style adapted to your field

% PACKAGES FOR THE APPENDIX
\usepackage{appendix}

% PACKAGES FOR ITEMIZE & ENUMERATES 
\usepackage{enumitem}

% OTHER PACKAGES
\usepackage{amsthm,thmtools,xcolor} % Coloured "Theorem"
\usepackage{comment} % Comment part of code
\usepackage{fancyhdr} % Fancy headers and footers
\usepackage{lipsum} % Insert dummy text
\usepackage{tcolorbox} % Create coloured boxes (e.g. the one for the key-words)
\usepackage{stfloats} % Correct position of the tables

%-------------------------------------------------------------------------
%	NEW COMMANDS DEFINED
%-------------------------------------------------------------------------
% EXAMPLES OF NEW COMMANDS -> here you see how to define new commands
\newcommand{\bea}{\begin{eqnarray}} % Shortcut for equation arrays
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\e}[1]{\times 10^{#1}}  % Powers of 10 notation
\newcommand{\mathbbm}[1]{\text{\usefont{U}{bbm}{m}{n}#1}} % From mathbbm.sty
\newcommand{\pdev}[2]{\frac{\partial#1}{\partial#2}}
% NB: you can also override some existing commands with the keyword \renewcommand

%----------------------------------------------------------------------------
%	ADD YOUR PACKAGES (be careful of package interaction)
%----------------------------------------------------------------------------
\usepackage{adjustbox}
\usepackage{enumitem}

%----------------------------------------------------------------------------
%	ADD YOUR DEFINITIONS AND COMMANDS (be careful of existing commands)
%----------------------------------------------------------------------------


% Do not change Configuration_files/config.tex file unless you really know what you are doing. 
% This file ends the configuration procedures (e.g. customizing commands, definition of new commands)
\input{Executive_Configuration_files/config}

% Insert here the info that will be displayed into your Title page 
% -> title of your work
\renewcommand{\title}{Three-dimensional bin packing with vertical support}
% -> author name and surname
\renewcommand{\author}{Jacopo LibÃ¨}
% -> MSc course
\newcommand{\course}{Computer Science and Engineering - Ingegneria Informatica}
% -> advisor name and surname
\newcommand{\advisor}{Prof. Ola Jabali}
% IF AND ONLY IF you need to modify the co-supervisors you also have to modify the file Configuration_files/title_page.tex (ONLY where it is marked)
\newcommand{\firstcoadvisor}{Davide Croci} % insert if any otherwise comment
%\newcommand{\secondcoadvisor}{Name Surname} % insert if any otherwise comment
% -> academic year
\newcommand{\YEAR}{2021-2022}

%-------------------------------------------------------------------------
%	BEGIN OF YOUR DOCUMENT
%-------------------------------------------------------------------------
\begin{document}

%-----------------------------------------------------------------------------
% TITLE PAGE
%-----------------------------------------------------------------------------
% Do not change Configuration_files/TitlePage.tex (Modify it IF AND ONLY IF you need to add or delete the Co-advisors)
% This file creates the Title Page of the document
\input{Executive_Configuration_files/title_page}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     THESIS MAIN TEXT     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%% \section{Guidelines}
%% \label{sec:guidelines}
%% 
%% The Executive Summary is a critical overview of your thesis
%% with a focus on the main achievements that have emerged from your research.
%% 
%% The Executive Summary should be organized in sections/paragraphs
%% in order to better highlight the major points of your work.
%% The length should range from four to six pages depending on the length of the thesis manuscript.
%% Keep the Executive Summary concise enough to be effective but long enough to allow it to be complete.
%% It should be written after completing the thesis manuscript as a stand-alone independent document
%% of sufficient clarity and detail to ensure that the reader can figure out the overall objectives,
%% the methodology employed and the results/impact of your research.
%% 
%% In writing the Executive Summary, keep in mind that it is not an abstract, it is not a preface,
%% and it is not a random collection of highlights.
%% With a few exceptions, do not simply cut and paste whole sections or paragraphs of the thesis manuscript
%% into a disorganized and cluttered Executive Summary.
%% You should reorganize information to be informative as well as concise.
%% 
%% The Executive Summary could contain a few important equations related to your work.
%% It could also include the most relevant figures and tables taken or elaborated from the thesis manuscript.
%% 
%% You should also include in the Executive Summary the very essential bibliography of your study.
%% The number of selected references should range from three to five depending on the type of work.
%% 
%% The Executive Summary should contain a final section reporting the main conclusions drawn from your research.

%-----------------------------------------------------------------------------
% INTRODUCTION
%-----------------------------------------------------------------------------
\section{Introduction}
\label{sec:introduction}

Recent progress in the digitalization of industrial processes led to a rise in studies on the Three-Dimensional Bin Packing Problem (3D-BPP).
The problem consists in packing a set of three-dimensional items in the minimum number of bins without any overlap.
The 3D-BPP finds many applications in real-world industrial settings, such as the loading of boxes onto pallets (Pallet Loading Problem) or in containers (Container Loading Problem). 
Studies in the application areas mentioned above have shown that 3D-BPP can be successfully applied to industrial problems, as long as it is extended with new practical constraints. 
Many works in the literature state that one of the most important practical constraints is vertical support (\cite{BORTFELDT20131}), i.e. the fact that each item has sufficient support to keep it from falling.
In this thesis, we develop a new extension of the 3D-BPP that ensures vertical support for each item: the Three-Dimensional Bin Packing Problem with Vertical Support (3D-BPPVS).
Similarly to other works in the literature (\cite{GZARA20201062,paquay2016mixed}), we model this property as a constraint on the minimum amount of area or vertices that rest on other items.

Our research stems from the case study of a logistics company in northern Italy.
The company manages large warehouses where automated lines bring boxes to different packing stations, and then they are loaded onto pallets of standard size.
Since the company is dealing directly with customers' orders, boxes have very different sizes and are usually packed in smaller quantities.
Moreover, the assortment of items to pack is strongly heterogeneous, therefore the use of standard approaches based on layers of homogeneous boxes is impractical.
During the palletization, levels of already packed items are wrapped to ensure better overall stability of the pallet.
This wrapping procedure requires that the amount of unused space between items is minimal, a property that is measured with a metric called cage ratio.
Cage ratio is the ratio between the volume of the packed items inside a bin and the volume of the cuboid which surrounds them, the cage.
The cage has the same base as the bin and height equal to the highest packed item inside the bin.
Current commercial solutions employed by the company pack items with an average cage ratio of $60\%$, and a target of $70\%$ was set as a baseline for our work.
A visual representation of the cage ratio is shown in \cref{fig:cage_ratio}.

\begin{figure}[h]
    \resizebox{\columnwidth}{!}{%
    \input{Images/cage_ratio_big}
    }
    \caption{Cage ratio of two different bin configurations}
    \label{fig:cage_ratio}
\end{figure}

In this thesis we
\begin{itemize}
    \item formulate a mixed-integer linear programming model for the 3D-BPPVS with a discretized version of the support constraint,
    \item develop a constructive heuristic that fills bins while guaranteeing vertical support, without explicitly building layered solutions,
    \item introduce a beam search heuristic that expands the constructive heuristic's solution space by exploring different orders of item palletization,
    \item validate the proposed heuristic against our model and against the most relevant heuristics from the 3D-BPP literature,
    \item generate and share a data set based on real-world instances that we use to benchmark our heuristic.
\end{itemize}

\section{Literature Review}
The 3D-BPP is the generalization of the one-dimensional bin packing problem which is NP-Hard (\cite{martello2000three}).
Exact methods can only solve small instances of the problem, which means that most solutions proposed in the literature are heuristics.
Heuristics for the 3D-BPP are designed to solve the standard problem and don't take into account practical constraints.
\cite{martello2000three} provided a set of benchmark instances for 3D-BPP heuristics, and an exact method based on a two-level branch-and-bound algorithm.
Their method used a staircase placement strategy, where a series of corner points were identified as possible placement points to evaluate.
The method was later extended in \cite{crainic2008extreme} to find new placement niches that were previously ignored, introducing the concept of Extreme Points.
\cite{gonccalves2013biased} introduced a biased random-key genetic algorithm (BRKGA) for the 3D-BPP, which is one of the best performing heuristics on the benchmark instances of \cite{martello2000three}.
Their algorithm was later extended in \cite{zudio2018brkga} by incorporating a variable neighborhood descent procuedure, which improved the number of generations needed to find high-quality results.

The concept of vertical support received most of its contribution from the literature of Container Loading Problems (CLP) and Pallet Loading Problems (PLP).
As noted in \cite{BORTFELDT20131}, static stability is usually implicitly enforced as a consequence of load compactness, or explicitly guaranteed by using filler material in a post-processing step.
Most heuristics for CLPS and PLPs try to build dense layers composed of similar items that they stack, reducing the problem to a one-dimensional bin packing problem.
Layers are filtered based on the fill-rate and when they are below a certain threshold they are discarded (e.g., \cite{elhedhli2019three, Alonso2020}).
This means that when no new layer can be built, new bins are opened, simpler placement methods are used to pack the remaining items or filler material is used to complete the layers.

Our solution to the problem fills the gap in the research by finding solutions to the 3D-BPPVS without explicitly building layers, and without the use of filler material.

\section{Proposed Solution}

Based on other publications from the literature and on our case study partner's insights, we state that an item is vertically supported if one of the following conditions hold.

\begin{enumerate}[label={\textbf{Condition \arabic*}.},ref={\arabic*},leftmargin=*]
    \item the percentage of base area that leans on other items is larger than a predetermined threshold $\alpha_s$. \label{support:area_support}
    \item the number of vertices resting on other items is greater than or equal to 3, and Condition \ref{support:area_support} is met with a smaller threshold $\alpha^\prime_s$. \label{support:vertex_support}
\end{enumerate}
We consider two items to be of equal height if their heights do not differ more than a tolerance threshold $\beta_s$
A visual representation of both support conditions is presented in \cref{fig:support}.

\begin{figure}[h]
    \resizebox{\columnwidth}{!}{%
    \input{Images/support_big}
    }
    \caption{Representation of an item with conditions \ref{support:area_support} and \ref{support:vertex_support} of vertical support given $\alpha_s = 0.5, \beta_s$}
    \label{fig:support}
\end{figure}

To solve the 3D-BPPVS, we propose an heuristic that combines a constructive heuristic with a beam-search algorithm.
The main idea of the heuristic is to build solutions to the 3D-BPPVS without explicitly building layers, and without the use of filling material.
The constructive heuristic is designed to solve a single-bin packing problem with vertical support, while the beam-search expands the heuristic's solutions by exploring different sequences of item placements.
A conceptual representation of the heuristic can be seen in \cref{fig:heur_scheme}.
\begin{figure}[h]
    \resizebox{\columnwidth}{!}{%
    \input{Images/heur_scheme}
    }
    \caption{Conceptual representation of the proposed heuristic}
    \label{fig:heur_scheme}
\end{figure}


We develop a new constructive heuristic for the single-bin 3D-BPP called Support Planes (SP).
This heuristic sequentially inserts items within the bin, placing them on top of other items already placed.
In this way it is always possible to guarantee vertical support for the inserted items.
Given a set of already positioned items, we define the two-dimensional plane that rests on the top face of those items as a support plane. Since each item is placed at different elevations and has different heights, each bin will have multiple support planes. Each support plane is identified by its coordinate on the vertical axis ($z$), has regions where there is no support from items below, and has regions where it is not possible to place items without having overlap with other placed items.

The insertion of items into a bin is performed by solving a two-dimensional bin packing problem (2D-BPP) for each support plane. 
Such 2D-BPP takes into account regions without vertical support and regions with obstacles.
For each support plane we test the insertion of each item. The plane is selected with a first-fit strategy starting from the lowest $z$, while the items to be inserted are selected with a best-fit strategy until the selected plane is filled.
The best-fit strategy is based on selecting items that can generate well-supported planes along with the already placed items. In addition, placements are also intended to avoid over-satisfying the support constraint, which could lead to unbalanced bins as reported in \cite{elhedhli2019three}.

To reduce the number of placements to consider, we propose two SP configurations: in the first, 2D-BPP is solved for single item placement (PS), while in the second, 2D-BPP is solved for placement of groups of items with the same dimensions (PM).
We solve the aforementioned 2D-BPP with a new modified version of the Extreme Points algorithm proposed in \cite{crainic2008extreme}.
In our implementation we use several tricks to improve performance, such as the use of axis-align bounding box trees for fast collision checks (\cite{bergen1997efficient}).

Our studies have shown that choosing placements with a best-fit strategy does not achieve satisfactory solutions. For this reason, we extend our constructive heuristics with a beam-search algorithm. 
We define a solution as a set of open bins with their packed items. We say that a solution is partial if there are items that still need to be packed.
Our beam-search algorithm starts from the empty solution and iteratively explores $k$ new partial solutions.
These partial solutions are generated from the solutions of the previous iteration by applying SP. 
Whenever SP is not able to place items in the opened bins of a partial solution, a new bin is opened.
Since each new partial solution is obtained by inserting a positive amount of items in another partial solution, the algorithm will always converge to a set of solutions where no item is unpacked.
To limit the number of partial solutions that are considered at each iteration, we define a ranking between them, using metrics that are related to the objective function of our MILP model.
We rank these solutions considering the number of opened bins, the amount of packed volume and the average cage ratio among opened bins.
Since different sequences of placements can lead to the same partial solution, we also develop a removal procedure that filters duplicate solutions based on an hashing function.


%-----------------------------------------------------------------------------
% CONCLUSION
%-----------------------------------------------------------------------------
\section{Conclusions}
In this thesis, we presented an heuristic for the Three-Dimensional Bin Packing Problem with Vertical Support.
We modified the two-dimensional Extreme Points algorithm of \citet{crainic2008extreme} to consider vertical support.
We then used this modified algorithm in a constructive heuristic which builds solutions to the single bin three-dimensional bin packing problem by filling planes, generated based on the previously inserted items.
Finally, we introduced a beam-search algorithm that evaluates different sequences of item placements by using our proposed constructive heuristic, and removes duplicate solutions at each iteration.

We tested a relaxed version of our heuristic without the support constraint and the rotation of items on the benchmark instances for the 3D-BPP proposed by \cite{martello2000three}.
Our heuristic achieved an average gap of $5.37\%$ against the best solutions in the literature, however we were able to solve the same instances in a fraction of their computational time.
We consider this as a great result since it states that our algorithm is competitive also in the realm of 3D-BPP without support.
We generated a data set of problem instances based on real-world products from our case study, and we used them to evaluate our heuristic.
In most configurations, our solutions exceeded the target metric of $70\%$ cage ratio, with some configurations having a negligible execution time.
In \cref{results:usecase_summary} we report the average execution time (\textit{TT}) in milliseconds, number of opened bins (B), and cage ratio (\textit{CR}) across all our case study instances. Each row of the table reports the aggregated results on all instances with different value of $k$.
Different placement modes are marked as PS (single placement) and PM (multiple items per placements).
In \cref{exp:usecase_tradeoff} we analyze the trade off between running times and cage ratio obtained by each configuration of the heuristic.
We list the difference between the average running time of each configuration (\textit{TT}) and the best average running time (\textit{TT*}), together with the difference between best average cage ratio (\textit{CR*}) and the average cage ratio obtained by each configuration (\textit{CR}).
We discover that the most promising configuration for our industrial partner consists in using the PM placement mode with $k \in {20, 50}$.

Further research could introduce new practical constraints such as family groupings, load-bearing, and compatibility between items.
Improvement heuristics could also be adapted to account for vertical support, such as the space defragmentation techniques introduced by \cite{ZHU2012452}.

\input{tests/use_case_avg_global}
\input{tests/use_case_tradeoff_summary}

\begin{figure}
    \centering
    \includegraphics[width = \columnwidth]{tests/usecase/instance-82_k200.PNG}
    \caption{Solution to Instance 82 from case study tests}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width = \columnwidth]{tests/usecase/instance-66_bin1_k200.PNG}
    \caption{Solution to Instance 66, Bin 1 from case study tests}
\end{figure}

%---------------------------------------------------------------------------
%  ACKNOWLEDGEMENTS 
%---------------------------------------------------------------------------
\section{Acknowledgements}
My deepest gratitude goes to my supervisors, Prof. Ola Jabali and Dr. Davide Croci for their insights and support.
This work wouldn't have been possible without them.\\
\\
Thanks to the team at ERMES-X s.r.l who provided me with the case study and the data used for our experiments.\\
\\
Many thanks to my family, my mom Patrizia, my father Severino, and my sister Giulia for always supporting me during this journey.
Last but not least, thanks to my colleagues Alberto, Edoardo, Mirko, and Kevin, that brightened every day at the university.

%---------------------------------------------------------------------------
%  BIBLIOGRAPHY
%---------------------------------------------------------------------------
% Remember to insert here only the essential bibliography of your work
\setcitestyle{numbers} % set the citation style to ``numbers''.
\bibliography{literature.bib} % automatically inserted and ordered with this command 

\end{document}